import{l as m,m as c,s as u,h as d}from"./index-CYA54aLl.js";import"./sweetalert2-B0Dix5B2.js";import"./axios-D8rVyQy1.js";document.addEventListener("DOMContentLoaded",function(){document.getElementById("loginForm").addEventListener("submit",function(s){var i,n,l;s.preventDefault(),m();const o=((i=document.getElementById("usuario"))==null?void 0:i.value.trim())||"",t=((n=document.getElementById("contrasena"))==null?void 0:n.value.trim())||"",a=((l=document.getElementById("codigo_2fa"))==null?void 0:l.value.trim())||"";if(!o||!t){c({usuario:o?[]:["El usuario es obligatorio."],contrasena:t?[]:["La contraseña es obligatoria."]});return}let r={usuario:o,contrasena:t};a&&(r.codigo_2fa=a),u("/api/auth/login","POST",r,e=>{if(e.resultado){if(localStorage.setItem("token",e.token),localStorage.setItem("roles",JSON.stringify(e.roles)),localStorage.setItem("permisos",JSON.stringify(e.permisos)),e.clave_2fa){console.warn("Se requiere configuración de 2FA."),localStorage.setItem("clave_2fa",e.clave_2fa),localStorage.setItem("clave_2fa_url",e.clave_2fa_url),window.location.href="/registro-2fa";return}window.location.href="/home"}else c(e.errors||{error:[e.message]})},e=>{console.error("Error en login:",e),d(e)})})});
